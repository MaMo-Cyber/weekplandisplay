<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wochenplan & Stickerkarte</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #e0f7fa; padding: 20px; margin: 0; }
    .container { max-width: 1000px; margin: auto; }
    h1, h2 { text-align: center; }
    table { width: 100%; border-collapse: collapse; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; }
    th { background: #a5d6a7; }
    input, select { width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
    button { font-size: 20px; background: none; border: none; cursor: pointer; }
    .progress-bar { width: 100%; background: #ddd; height: 20px; border-radius: 10px; }
    .progress-fill { height: 100%; background: #4caf50; border-radius: 10px; }
    ul { list-style-type: disc; margin-left: 20px; }
    .reward-form { margin: 10px 0; display: flex; flex-direction: column; gap: 10px; }
    .reward-form input[type="number"] { width: 80px; }
    .reward-form button { background: #4caf50; color: white; padding: 5px 10px; border-radius: 4px; }
    .reset-button { background: #ef5350; color: white; padding: 5px 10px; border-radius: 4px; margin: 5px; }
    .menu-button { position: fixed; top: 10px; right: 10px; background: #4caf50; color: white; padding: 10px; border-radius: 4px; cursor: pointer; font-size: 18px; z-index: 2000; }
    .menu { position: fixed; top: 0; right: -320px; width: 300px; height: 100%; background: #fff; transition: right 0.3s; padding: 20px; }
    .menu.open { right: 0; box-shadow: -2px 0 5px rgba(0,0,0,0.2); }
    .menu-content { display: flex; flex-direction: column; gap: 10px; }
    .menu-content label { font-weight: bold; }
    .menu-header { display: flex; justify-content: flex-end; align-items: center; gap: 10px; }
    .close-button { background: #ef5350; color: white; padding: 5px 10px; border-radius: 4px; }
    .color-picker { margin-left: 5px; width: 20px; height: 20px; vertical-align: middle; }
    .plan-cell { display: flex; align-items: center; gap: 5px; }
    .plan-input { flex: 1; }
    .reward-list { margin: 10px 0; max-height: 200px; overflow-y: auto; }
    .reward-list li { display: flex; align-items: center; gap: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Wochenplan für <span id="childNameDisplay"></span></h1>
    <button class="menu-button" onclick="toggleMenu()">⚙️ Einstellungen</button>
    <div class="menu" id="settingsMenu">
      <div class="menu-content">
        <div class="menu-header">
          <button class="close-button" onclick="toggleMenu()">✖ Schließen</button>
        </div>
        <h2>Einstellungen</h2>
        <label>Name:</label>
        <input id="childName" placeholder="Dein Name">
        <label>Farbe auswählen (Hintergrund):</label>
        <select id="colorTheme">
          <option value="#e0f7fa">Blau</option>
          <option value="#c8e6c9">Grün</option>
          <option value="#fff9c4">Gelb</option>
          <option value="#fce4ec">Pink</option>
        </select>
        <label>Schriftgröße:</label>
        <select id="fontSize">
          <option value="14px">Klein</option>
          <option value="16px" selected>Mittel</option>
          <option value="18px">Groß</option>
        </select>
        <label>Schriftart:</label>
        <select id="fontFamily">
          <option value="Arial, sans-serif">Arial</option>
          <option value="'Comic Sans MS', cursive, sans-serif">Comic Sans</option>
          <option value="'Open Sans', sans-serif">Open Sans</option>
        </select>
        <label>Neue Belohnung hinzufügen:</label>
        <div class="reward-form">
          <input id="rewardText" type="text" placeholder="Neue Belohnung (z. B. Eis essen)">
          <input id="rewardStars" type="number" min="1" max="30" placeholder="Sterne">
          <button onclick="addReward()">Hinzufügen</button>
        </div>
        <label>Belohnungen löschen:</label>
        <ul class="reward-list" id="deleteRewardList"></ul>
        <button class="reset-button" onclick="deleteSelectedRewards()">Ausgewählte Belohnungen löschen</button>
        <button class="reset-button" onclick="resetStars()">Sterne zurücksetzen</button>
        <button class="reset-button" onclick="resetRewards()">Alle Belohnungen zurücksetzen</button>
      </div>
    </div>

    <h2>Wochenplan</h2>
    <table id="weekPlan">
      <thead>
        <tr>
          <th>Tag</th><th>Morgens</th><th>Nachmittags</th><th>Abends</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Montag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="0" data-col="1"><input type="color" class="color-picker" data-row="0" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="0" data-col="2"><input type="color" class="color-picker" data-row="0" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="0" data-col="3"><input type="color" class="color-picker" data-row="0" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Dienstag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="1" data-col="1"><input type="color" class="color-picker" data-row="1" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="1" data-col="2"><input type="color" class="color-picker" data-row="1" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="1" data-col="3"><input type="color" class="color-picker" data-row="1" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Mittwoch</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="2" data-col="1"><input type="color" class="color-picker" data-row="2" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="2" data-col="2"><input type="color" class="color-picker" data-row="2" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="2" data-col="3"><input type="color" class="color-picker" data-row="2" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Donnerstag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="3" data-col="1"><input type="color" class="color-picker" data-row="3" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="3" data-col="2"><input type="color" class="color-picker" data-row="3" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="3" data-col="3"><input type="color" class="color-picker" data-row="3" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Freitag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="4" data-col="1"><input type="color" class="color-picker" data-row="4" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="4" data-col="2"><input type="color" class="color-picker" data-row="4" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="4" data-col="3"><input type="color" class="color-picker" data-row="4" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Samstag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="5" data-col="1"><input type="color" class="color-picker" data-row="5" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="5" data-col="2"><input type="color" class="color-picker" data-row="5" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="5" data-col="3"><input type="color" class="color-picker" data-row="5" data-col="3"></div></td>
        </tr>
        <tr>
          <td>Sonntag</td>
          <td><div class="plan-cell"><input class="plan-input" data-row="6" data-col="1"><input type="color" class="color-picker" data-row="6" data-col="1"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="6" data-col="2"><input type="color" class="color-picker" data-row="6" data-col="2"></div></td>
          <td><div class="plan-cell"><input class="plan-input" data-row="6" data-col="3"><input type="color" class="color-picker" data-row="6" data-col="3"></div></td>
        </tr>
      </tbody>
    </table>

    <h2>Stickerkarte</h2>
    <table id="stickerChart">
      <thead>
        <tr>
          <th>Ziel</th><th>Mo</th><th>Di</th><th>Mi</th><th>Do</th><th>Fr</th><th>Sa</th><th>So</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>2 Lernblöcke geschafft</td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td></tr>
        <tr><td>Pause gemacht</td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td></tr>
        <tr><td>Aufgabe ohne Hilfe</td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td><td><button onclick="addStar(this)">⭐</button></td></tr>
      </tbody>
    </table>

    <h2>Wochenbelohnung</h2>
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <p>Fortschritt: <span id="totalStars">0</span>/30 Sterne</p>
    <h3>Belohnungen</h3>
    <ul id="rewardList"></ul>
  </div>

  <script>
    let stars = JSON.parse(localStorage.getItem('stars')) || {};
    let rewards = JSON.parse(localStorage.getItem('rewards')) || [];
    let totalStars = 0;

    function toggleMenu() {
      const menu = document.getElementById('settingsMenu');
      menu.classList.toggle('open');
    }

    function addStar(button) {
      const cell = button.parentElement;
      const day = cell.cellIndex;
      const task = cell.parentElement.rowIndex;
      const key = `${day}-${task}`;
      stars[key] = (stars[key] || 0) + 1;
      if (stars[key] > 2) stars[key] = 2;
      button.innerHTML = '⭐'.repeat(stars[key]);
      updateProgress();
      localStorage.setItem('stars', JSON.stringify(stars));
    }

    function resetStars() {
      stars = {};
      document.querySelectorAll('#stickerChart button').forEach(button => {
        button.innerHTML = '⭐';
      });
      updateProgress();
      localStorage.setItem('stars', JSON.stringify(stars));
    }

    function addReward() {
      const text = document.getElementById('rewardText').value;
      const stars = parseInt(document.getElementById('rewardStars').value);
      if (text && stars > 0 && stars <= 30) {
        rewards.push({ text, stars });
        rewards.sort((a, b) => a.stars - b.stars);
        updateRewards();
        localStorage.setItem('rewards', JSON.stringify(rewards));
        document.getElementById('rewardText').value = '';
        document.getElementById('rewardStars').value = '';
      }
    }

    function deleteSelectedRewards() {
      const checkboxes = document.querySelectorAll('#deleteRewardList input:checked');
      const indices = Array.from(checkboxes).map(cb => parseInt(cb.dataset.index)).sort((a, b) => b - a);
      indices.forEach(index => rewards.splice(index, 1));
      updateRewards();
      localStorage.setItem('rewards', JSON.stringify(rewards));
    }

    function resetRewards() {
      rewards = [];
      updateRewards();
      localStorage.setItem('rewards', JSON.stringify(rewards));
    }

    function updateRewards() {
      const list = document.getElementById('rewardList');
      const deleteList = document.getElementById('deleteRewardList');
      list.innerHTML = '';
      deleteList.innerHTML = '';
      rewards.forEach((reward, index) => {
        const li = document.createElement('li');
        li.textContent = `${reward.stars} Sterne: ${reward.text}`;
        list.appendChild(li);
        const deleteLi = document.createElement('li');
        deleteLi.innerHTML = `<input type="checkbox" data-index="${index}"> ${reward.stars} Sterne: ${reward.text}`;
        deleteList.appendChild(deleteLi);
      });
    }

    function updateProgress() {
      totalStars = Object.values(stars).reduce((sum, count) => sum + count, 0);
      document.getElementById('totalStars').textContent = totalStars;
      document.getElementById('progressFill').style.width = `${(totalStars / 30) * 100}%`;
    }

    document.getElementById('childName').addEventListener('input', (e) => {
      localStorage.setItem('childName', e.target.value);
      document.getElementById('childNameDisplay').textContent = e.target.value || 'Dein Name';
    });
    document.getElementById('childName').value = localStorage.getItem('childName') || '';
    document.getElementById('childNameDisplay').textContent = localStorage.getItem('childName') || '';

    document.getElementById('colorTheme').addEventListener('change', (e) => {
      document.body.style.backgroundColor = e.target.value;
      localStorage.setItem('colorTheme', e.target.value);
    });
    document.body.style.backgroundColor = localStorage.getItem('colorTheme') || '#e0f7fa';

    document.getElementById('fontSize').addEventListener('change', (e) => {
      document.body.style.fontSize = e.target.value;
      localStorage.setItem('fontSize', e.target.value);
    });
    document.body.style.fontSize = localStorage.getItem('fontSize') || '16px';

    document.getElementById('fontFamily').addEventListener('change', (e) => {
      document.body.style.fontFamily = e.target.value;
      localStorage.setItem('fontFamily', e.target.value);
    });
    document.body.style.fontFamily = localStorage.getItem('fontFamily') || 'Arial, sans-serif';

    const inputs = document.querySelectorAll('#weekPlan .plan-input');
    inputs.forEach(input => {
      const row = input.dataset.row;
      const col = input.dataset.col;
      const key = `${row}-${col}`;
      const colorKey = `color-${row}-${col}`;
      input.value = localStorage.getItem(key) || '';
      input.style.backgroundColor = localStorage.getItem(colorKey) || '';
      input.addEventListener('input', (e) => {
        localStorage.setItem(key, e.target.value);
      });
    });

    const colorPickers = document.querySelectorAll('.color-picker');
    colorPickers.forEach(picker => {
      const row = picker.dataset.row;
      const col = picker.dataset.col;
      const colorKey = `color-${row}-${col}`;
      picker.value = localStorage.getItem(colorKey) || '#ffffff';
      picker.addEventListener('input', (e) => {
        const input = document.querySelector(`.plan-input[data-row="${row}"][data-col="${col}"]`);
        input.style.backgroundColor = e.target.value;
        localStorage.setItem(colorKey, e.target.value);
      });
    });

    updateProgress();
    updateRewards();

    // Setze Standardwerte für den Wochenplan
    const defaultPlan = [
      ['Schule', 'Hausaufgaben, Lernblock 1+2', 'Ruhige Spielzeit'],
      ['Schule', 'Konzentrationstraining / Sport', 'Hörspiel / Lesen'],
      ['Schule', 'Freizeit (Highlight!)', 'Gesellschaftsspiel'],
      ['Schule', 'Lernblock + Kreativzeit', 'Malen / Basteln'],
      ['Schule', 'Spielplatz / Freizeit', 'Kinonachmittag zuhause'],
      ['Haushalt helfen', 'Ausflug / Spielen', 'Wochenrückblick + Belohnung'],
      ['Entspannen', 'Gesellschaftsspiel / Spaziergang', 'Vorbereiten auf Montag']
    ];
    inputs.forEach(input => {
      const row = parseInt(input.dataset.row);
      const col = parseInt(input.dataset.col);
      const key = `${row}-${col}`;
      if (!localStorage.getItem(key)) {
        input.value = defaultPlan[row][col - 1];
        localStorage.setItem(key, input.value);
      }
    });
  </script>
</body>
</html>
